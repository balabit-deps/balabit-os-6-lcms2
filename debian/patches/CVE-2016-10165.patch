From 5ca71a7bc18b6897ab21d815d15e218e204581e2 Mon Sep 17 00:00:00 2001
From: Marti <marti.maria@tktbrainpower.com>
Date: Mon, 15 Aug 2016 23:31:39 +0200
Subject: [PATCH] Added an extra check to MLU bounds

Thanks to Ibrahim el-sayed for spotting the bug
---
 src/cmstypes.c | 1 +
 1 file changed, 1 insertion(+)

Index: lcms2-2.6/src/cmstypes.c
===================================================================
--- lcms2-2.6.orig/src/cmstypes.c
+++ lcms2-2.6/src/cmstypes.c
@@ -1455,6 +1455,7 @@ void *Type_MLU_Read(struct _cms_typehand
 
         // Check for overflow
         if (Offset < (SizeOfHeader + 8)) goto Error;
+        if ((Offset + Len) > SizeOfTag + 8) goto Error;
 
         // True begin of the string
         BeginOfThisString = Offset - SizeOfHeader - 8;
